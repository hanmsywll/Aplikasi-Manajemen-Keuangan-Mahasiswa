<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen Keuangan Mahasiswa</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* CSS Styling */
    </style>
</head>

<body>
    <div class="container mt-5">
        <div class="row">
            <!-- Kolom kiri untuk pengeluaran -->
            <div class="col-md-6">
                <h2>Pengeluaran</h2>
                <form id="transaksiForm">
                    <div class="form-group">
                        <label for="nominal">Nominal:</label>
                        <input type="number" class="form-control" id="nominal" placeholder="Nominal" required>
                    </div>
                    <div class="form-group">
                        <label for="kategori">Kategori:</label>
                        <select class="form-control" id="kategori" required>
                            <option value="" selected disabled>Pilih Kategori</option>
                            <option value="makanan">Makanan</option>
                            <option value="kesehatan">Kesehatan</option>
                            <option value="transportasi">Transportasi</option>
                            <option value="komunikasi">Komunikasi</option>
                            <option value="wajib">Kebutuhan Wajib</option>
                            <option value="akademik">Kebutuhan Akademik</option>
                            <option value="hiburan">Hiburan</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tanggal">Tanggal:</label>
                        <input type="date" class="form-control" id="tanggal" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Tambah Pengeluaran</button>
                </form>
                <br>
                <h3>Data Pengeluaran</h3>
                <table class="table">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col">No.</th>
                            <th scope="col">Nominal</th>
                            <th scope="col">Kategori</th>
                            <th scope="col">Tanggal</th>
                            <th scope="col">Action</th>
                        </tr>
                    </thead>
                    <tbody id="keuangan">
                    </tbody>
                </table>
            </div>
            <!-- Kolom kanan untuk pemasukan -->
            <div class="col-md-6">
                <h2>Manajemen Pemasukan</h2>
                <form id="FormPemasukan">
                    <div class="form-group">
                        <label for="amountInput">Jumlah Pemasukan:</label>
                        <input type="number" id="amountInput" class="form-control" placeholder="Jumlah Pemasukan"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="categoryInput">Kategori:</label>
                        <select id="categoryInput" class="form-control" required>
                            <option value="">Pilih Kategori</option>
                            <option value="Mandiri">Mandiri</option>
                            <option value="Eksternal">Eksternal</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="descriptionInput">Deskripsi:</label>
                        <input type="text" id="descriptionInput" class="form-control" placeholder="Deskripsi Pemasukan"
                            required>
                    </div>
                    <button type="submit" class="btn btn-primary">Tambah Pemasukan</button>
                </form>
                <div id="keuanganList" class="mt-5">
                    <h3>Daftar Pemasukan</h3>
                    <table id="keuanganTable" class="table">
                        <thead>
                            <tr>
                                <th scope="col">No</th>
                                <th scope="col">Tanggal</th>
                                <th scope="col">Kategori</th>
                                <th scope="col">Nominal</th>
                                <th scope="col">Deskripsi</th>
                                <th scope="col">Action</th>
                            </tr>
                        </thead>
                        <tbody id="keuanganTableBody"></tbody>
                    </table>
                    <p id="totalIncome"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
        // Objek untuk menyimpan data Pemasukan
        let finances = {
            keuangan: []
        };

        // Fungsi untuk menampilkan daftar Pemasukan
        function tampilkanListPemasukan() {
            let keuanganTableBody = document.getElementById("keuanganTableBody");
            keuanganTableBody.innerHTML = "";
            finances.keuangan.forEach((item, index) => {
                let row = `<tr>
                            <td>${index + 1}</td>
                            <td>${item.date}</td>
                            <td>${item.category}</td>
                            <td> Rp. ${item.amount}</td>
                            <td>${item.description}</td>
                            <td>
                                <button class="btn btn-primary" onclick="editPemasukan(${index})">Edit</button>
                                <button class="btn btn-danger" onclick="hapusPemasukan(${index})">Hapus</button>
                            </td>
                        </tr>`;
                keuanganTableBody.innerHTML += row;
            });

            // Menampilkan jumlah nominal Pemasukan
            let totalIncome = finances.keuangan.reduce((total, item) => total + item.amount, 0);
            document.getElementById("totalIncome").innerText = `Total Pemasukan: Rp. ${totalIncome}`;
        }

        // Fungsi untuk menambahkan Pemasukan
        function TambahPemasukan(amount, category, description) {
            let date = new Date().toLocaleDateString();
            finances.keuangan.push({ amount, category, description, date });
            tampilkanListPemasukan(); // Update daftar Pemasukan
        }

        // Fungsi untuk memproses form input Pemasukan
        const FormPemasukan = document.getElementById("FormPemasukan");
        FormPemasukan.addEventListener("submit", function (event) {
            event.preventDefault(); // Mencegah form untuk melakukan submit default

            // Mengambil nilai input dari form
            let amount = parseFloat(document.getElementById("amountInput").value);
            let category = document.getElementById("categoryInput").value;
            let description = document.getElementById("descriptionInput").value;

            // Memastikan input jumlah adalah angka positif
            if (isNaN(amount) || amount <= 0) {
                alert("Masukkan jumlah Pemasukan yang valid (angka positif).");
                return;
            }

            // Menambahkan Pemasukan ke dalam data
            TambahPemasukan(amount, category, description);
            // Mengosongkan form setelah Pemasukan ditambahkan
            FormPemasukan.reset();
        });

        // Fungsi untuk mengedit Pemasukan
        function editPemasukan(index) {
            let newAmount = parseFloat(prompt("Masukkan jumlah Pemasukan baru:"));

            // Memastikan input jumlah adalah angka positif
            if (isNaN(newAmount) || newAmount <= 0) {
                alert("Masukkan jumlah Pemasukan yang valid (angka positif).");
                return;
            }

            // Update data Pemasukan
            finances.keuangan[index].amount = newAmount;

            // Tampilkan ulang daftar Pemasukan
            tampilkanListPemasukan();
        }

        // Fungsi untuk menghapus Pemasukan
        function hapusPemasukan(index) {
            // Konfirmasi sebelum menghapus
            if (confirm("Apakah Anda yakin ingin menghapus Pemasukan ini?")) {
                // Hapus data Pemasukan dari array
                finances.keuangan.splice(index, 1);
                // Tampilkan ulang daftar Pemasukan
                tampilkanListPemasukan();
            }
        }

        // Deklarasi variabel untuk menyimpan data transaksi

        // Menangani submit form
        document.getElementById("transaksiForm").addEventListener("submit", function (event) {
            event.preventDefault(); // Mencegah form dari melakukan submit default

            // Mendapatkan nilai dari input
            const nominal = parseFloat(document.getElementById("nominal").value);
            const kategori = document.getElementById("kategori").value;
            const tanggal = document.getElementById("tanggal").value;

            // Memanggil fungsi untuk menambahkan transaksi ke dalam array
            tambahPengeluaran(nominal, kategori, tanggal);
        });

        // Fungsi untuk menambahkan transaksi ke dalam array
        function tambahPengeluaran(nominal, kategori, tanggal) {
            // Menambahkan objek transaksi baru ke dalam array
            finances.keuangan.push({
                nominal,
                kategori,
                tanggal,
            });

            // Memperbarui tampilan data
            tampilData();
        }

        // Fungsi untuk menampilkan data transaksi dalam tabel
        function tampilData() {
            const tableBody = document.querySelector("#keuangan");
            tableBody.innerHTML = ""; // Mengosongkan isi tabel sebelum menambahkan data baru

            // Loop melalui setiap transaksi dan menambahkannya ke dalam tabel
            finances.keuangan.forEach((transaksi, index) => {
                const row = tableBody.insertRow(); // Menambahkan baris baru ke tabel

                // Menambahkan data transaksi ke dalam sel-sel tabel
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>Rp${transaksi.nominal.toLocaleString()}</td>
                    <td>${transaksi.kategori}</td>
                    <td>${transaksi.tanggal}</td>
                    <td>
                        <button class="btn btn-primary mr-2" onclick="editNominal(${index})">Edit</button>
                        <button class="btn btn-danger" onclick="hapusPengeluaran(${index})">Delete</button>
                    </td>
                `;
            });
        }

        // Fungsi untuk mengubah nominal transaksi
        function editNominal(index) {
            const newNominal = prompt("Masukkan nominal baru:");
            if (newNominal !== null) {
                const parsedNominal = parseFloat(newNominal);
                if (!isNaN(parsedNominal)) {
                    finances.keuangan[index].nominal = parsedNominal;
                    tampilData();
                } else {
                    alert("Nominal yang dimasukkan tidak valid. Silakan masukkan angka yang valid.");
                }
            }
        }

        // Fungsi untuk menghapus transaksi
        function hapusPengeluaran(index) {
            if (confirm("Apakah Anda yakin ingin menghapus pengeluaran ini?")) {
                finances.keuangan.splice(index, 1);
                tampilData();
            }
        }
    </script>
</body>

</html>